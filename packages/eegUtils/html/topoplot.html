<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Topographical Plotting Function for EEG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for topoplot {eegUtils}"><tr><td>topoplot {eegUtils}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Topographical Plotting Function for EEG</h2>

<h3>Description</h3>

<p>Allows topographical plotting of functional data. Output is a ggplot2 object.
</p>
<p>The functions works for both standard data frames and objects of class
<code>eeg_data</code>.
</p>
<p>Both <code>eeg_epochs</code> and <code>eeg_data</code> objects are supported.
</p>


<h3>Usage</h3>

<pre>
topoplot(data, ...)

## S3 method for class 'data.frame'
topoplot(data, time_lim = NULL, limits = NULL,
  chanLocs = NULL, method = "Biharmonic", r = NULL, grid_res = 67,
  palette = "RdBu", interp_limit = "skirt", contour = TRUE,
  chan_marker = "point", quantity = "amplitude", montage = NULL,
  colourmap, ...)

## S3 method for class 'eeg_data'
topoplot(data, time_lim = NULL, limits = NULL,
  chanLocs = NULL, method = "Biharmonic", r = NULL, grid_res = 67,
  palette = "RdBu", interp_limit = "skirt", contour = TRUE,
  chan_marker = "point", quantity = "amplitude", montage = NULL, ...)

## S3 method for class 'eeg_ICA'
topoplot(data, time_lim = NULL, limits = NULL,
  chanLocs = NULL, method = "Biharmonic", r = NULL, grid_res = 67,
  palette = "RdBu", interp_limit = "skirt", contour = TRUE,
  chan_marker = "point", quantity = "amplitude", montage = NULL,
  colourmap, comp, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p>An EEG dataset. Must have columns x, y, and amplitude at present.
x and y are (Cartesian) electrode co-ordinates), amplitude is amplitude.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Various arguments passed to specific functions</p>
</td></tr>
<tr valign="top"><td><code>time_lim</code></td>
<td>
<p>Timepoint(s) to plot. Can be one time or a range to average
over. If none is supplied, the function will average across all timepoints
in the supplied data.</p>
</td></tr>
<tr valign="top"><td><code>limits</code></td>
<td>
<p>Limits of the fill scale - should be given as a character vector
with two values specifying the start and endpoints e.g. limits = c(-2,-2).
Will ignore anything else. Defaults to the range of the data.</p>
</td></tr>
<tr valign="top"><td><code>chanLocs</code></td>
<td>
<p>Allows passing of channel locations (see <code>electrode_locations</code>)</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>Interpolation method. &quot;Biharmonic&quot; or &quot;gam&quot;. &quot;Biharmonic&quot;
implements the same method used in Matlab's EEGLAB. &quot;gam&quot; fits a
Generalized Additive Model with k = 40 knots. Defaults to biharmonic spline
interpolation.</p>
</td></tr>
<tr valign="top"><td><code>r</code></td>
<td>
<p>Radius of cartoon head_shape; if not given, defaults to 1.1 * the
maximum y electrode location.</p>
</td></tr>
<tr valign="top"><td><code>grid_res</code></td>
<td>
<p>Resolution of the interpolated grid. Higher = smoother but
slower.</p>
</td></tr>
<tr valign="top"><td><code>palette</code></td>
<td>
<p>Defaults to RdBu if none supplied. Can be any from
RColorBrewer or viridis. If an unsupported palette is specified, switches
to Greens.</p>
</td></tr>
<tr valign="top"><td><code>interp_limit</code></td>
<td>
<p>&quot;skirt&quot; or &quot;head&quot;. Defaults to &quot;skirt&quot;. &quot;skirt&quot;
interpolates just past the farthest electrode and does not respect the
boundary of the head_shape. &quot;head&quot; interpolates up to the radius of the
plotted head.</p>
</td></tr>
<tr valign="top"><td><code>contour</code></td>
<td>
<p>Plot contour lines on topography (defaults to TRUE)</p>
</td></tr>
<tr valign="top"><td><code>chan_marker</code></td>
<td>
<p>Set marker for electrode locations. &quot;point&quot; = point,
&quot;name&quot; = electrode name, &quot;none&quot; = no marker. Defaults to &quot;point&quot;.</p>
</td></tr>
<tr valign="top"><td><code>quantity</code></td>
<td>
<p>Allows plotting of arbitrary quantitative column. Defaults to
amplitude. Use quoted column names. E.g. &quot;p.value&quot;, &quot;t_statistic&quot;.</p>
</td></tr>
<tr valign="top"><td><code>montage</code></td>
<td>
<p>Name of an existing montage set. Defaults to NULL; (currently
only 'biosemi64alpha' available other than default 10/20 system)</p>
</td></tr>
<tr valign="top"><td><code>colourmap</code></td>
<td>
<p>Deprecated, use palette instead.</p>
</td></tr>
<tr valign="top"><td><code>comp</code></td>
<td>
<p>Component to plot (numeric)</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>data.frame</code>: Topographical plotting of data.frames and other non
eeg_data objects.
</p>
</li>
<li> <p><code>eeg_data</code>: Topographical plotting of <code>eeg_data</code> objects.
</p>
</li>
<li> <p><code>eeg_ICA</code>: Topographical plot for <code>eeg_ICA</code> objects
</p>
</li></ul>


<h3>Notes on usage of Generalized Additive Models for interpolation</h3>

<p>The
function fits a GAM using the gam function from mgcv. Specifically, it fits
a spline using the model function gam(z ~ s(x, y, bs = &quot;ts&quot;, k = 40). Using
GAMs for smooths is very much experimental. The surface is produced from
the predictions of the GAM model fitted to the supplied data. Values at
each electrode do not necessarily match actual values in the data:
high-frequency variation will tend to be smoothed out. Thus, the method
should be used with caution.
</p>


<h3>Author(s)</h3>

<p>Matt Craddock, <a href="mailto:matt@mattcraddock.com">matt@mattcraddock.com</a>
</p>

<hr /><div style="text-align: center;">[Package <em>eegUtils</em> version 0.1.15.9001 <a href="00Index.html">Index</a>]</div>
</body></html>
