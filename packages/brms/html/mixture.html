<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Finite Mixture Families in 'brms'</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mixture {brms}"><tr><td>mixture {brms}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Finite Mixture Families in <span class="pkg">brms</span></h2>

<h3>Description</h3>

<p>Set up a finite mixture family for use in <span class="pkg">brms</span>.
</p>


<h3>Usage</h3>

<pre>
mixture(..., flist = NULL, nmix = 1, order = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>...</code></td>
<td>
<p>One or more objects providing a description of the 
response distributions to be combined in the mixture model. 
These can be family functions, calls to family functions or 
character strings naming the families. For details of supported 
families see <code><a href="brmsfamily.html">brmsfamily</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>flist</code></td>
<td>
<p>Optional list of objects, which are treated in the 
same way as objects passed via the <code>...</code> argument.</p>
</td></tr>
<tr valign="top"><td><code>nmix</code></td>
<td>
<p>Optional numeric vector specifying the number of times
each family is repeated. If specified, it must have the same length 
as the number of families passed via <code>...</code> or <code>flist</code>.</p>
</td></tr>
<tr valign="top"><td><code>order</code></td>
<td>
<p>Ordering constraint to identify mixture components.
If <code>'mu'</code> or <code>TRUE</code>, population-level intercepts
of the mean parameters are ordered. 
If <code>'none'</code> or <code>FALSE</code>, no ordering constraint is applied.
If <code>NULL</code> (the default), <code>order</code> is set to <code>'mu'</code>
if all families are the same and <code>'none'</code> otherwise.
Other ordering constraints may be implemented in the future.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Most families supported by <span class="pkg">brms</span> can be used to form 
mixtures. The response variable has to be valid for all components
of the mixture family. Currently, the number of mixture components 
has to be specified by the user. It is not yet possible to estimate 
the number of mixture components from the data.
</p>
<p>For most mixture models, you may want to specify priors on the population-level
intercepts via <code><a href="set_prior.html">set_prior</a></code> to improve convergence. 
In addition, it is sometimes necessary to set <code>inits = 0</code> in the call to 
<code><a href="brm.html">brm</a></code> to allow chains to initialize properly.
</p>
<p>For more details on the specification of mixture
models, see <code><a href="brmsformula.html">brmsformula</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>mixfamily</code>.
</p>


<h3>Examples</h3>

<pre>
## Not run: 
## simulate some data
set.seed(1234)
dat &lt;- data.frame(
  y = c(rnorm(200), rnorm(100, 6)), 
  x = rnorm(300),
  z = sample(0:1, 300, TRUE)
)

## fit a simple normal mixture model
mix &lt;- mixture(gaussian, gaussian)
prior &lt;- c(
  prior(normal(0, 7), Intercept, dpar = mu1),
  prior(normal(5, 7), Intercept, dpar = mu2)
)
fit1 &lt;- brm(bf(y ~ x + z), dat, family = mix,
            prior = prior, chains = 2) 
summary(fit1)
pp_check(fit1)

## use different predictors for the components
fit2 &lt;- brm(bf(y ~ 1, mu1 ~ x, mu2 ~ z), dat, family = mix,
            prior = prior, chains = 2) 
summary(fit2)

## fix the mixing proportions
fit3 &lt;- brm(bf(y ~ x + z, theta1 = 1, theta2 = 2), 
            dat, family = mix, prior = prior, 
            inits = 0, chains = 2)
summary(fit3)
pp_check(fit3)    

## predict the mixing proportions
fit4 &lt;- brm(bf(y ~ x + z, theta2 ~ x), 
            dat, family = mix, prior = prior, 
            inits = 0, chains = 2)
summary(fit4)
pp_check(fit4)           

## compare model fit
LOO(fit1, fit2, fit3, fit4)  

## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>brms</em> version 2.3.0 <a href="00Index.html">Index</a>]</div>
</body></html>
