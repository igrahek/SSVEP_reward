<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Posterior Probabilities of Mixture Component Memberships</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for pp_mixture.brmsfit {brms}"><tr><td>pp_mixture.brmsfit {brms}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Posterior Probabilities of Mixture Component Memberships</h2>

<h3>Description</h3>

<p>Compute the posterior probabilities of mixture component 
memberships for each observation including uncertainty
estimates.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'brmsfit'
pp_mixture(x, newdata = NULL, re_formula = NULL,
  allow_new_levels = FALSE, sample_new_levels = "uncertainty",
  new_objects = list(), incl_autocor = TRUE, resp = NULL, subset = NULL,
  nsamples = NULL, nug = NULL, summary = TRUE, robust = FALSE,
  probs = c(0.025, 0.975), log = FALSE, ...)

pp_mixture(x, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object usually of class <code>brmsfit</code>.</p>
</td></tr>
<tr valign="top"><td><code>newdata</code></td>
<td>
<p>An optional data.frame for which to evaluate predictions.
If <code>NULL</code> (default), the original data of the model is used.</p>
</td></tr>
<tr valign="top"><td><code>re_formula</code></td>
<td>
<p>formula containing group-level effects 
to be considered in the prediction. 
If <code>NULL</code> (default), include all group-level effects; 
if <code>NA</code>, include no group-level effects.</p>
</td></tr>
<tr valign="top"><td><code>allow_new_levels</code></td>
<td>
<p>A flag indicating if new
levels of group-level effects are allowed 
(defaults to <code>FALSE</code>). 
Only relevant if <code>newdata</code> is provided.</p>
</td></tr>
<tr valign="top"><td><code>sample_new_levels</code></td>
<td>
<p>Indicates how to sample new levels 
for grouping factors specified in <code>re_formula</code>.
This argument is only relevant if <code>newdata</code> is provided and 
<code>allow_new_levels</code> is set to <code>TRUE</code>.
If <code>"uncertainty"</code> (default), include group-level uncertainty
in the predictions based on the variation of the existing levels. 
If <code>"gaussian"</code>, sample new levels from the (multivariate) 
normal distribution implied by the group-level standard deviations 
and correlations. This options may be useful for conducting 
Bayesian power analysis. 
If <code>"old_levels"</code>, directly sample new levels from the
existing levels.</p>
</td></tr>
<tr valign="top"><td><code>new_objects</code></td>
<td>
<p>A named <code>list</code> of objects containing 
new data, which cannot be passed via argument <code>newdata</code>.
Currently, only required for objects passed to 
<code><a href="cor_sar.html">cor_sar</a></code> and 
<code><a href="cor_fixed.html">cor_fixed</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>incl_autocor</code></td>
<td>
<p>A flag indicating if ARMA autocorrelation
parameters should be included in the predictions. Defaults to 
<code>TRUE</code>. Setting it to <code>FALSE</code> will not affect other 
correlation structures such as <code><a href="cor_bsts.html">cor_bsts</a></code>,
or <code><a href="cor_fixed.html">cor_fixed</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>resp</code></td>
<td>
<p>Optional names of response variables.
If specified, fitted values of these response variables are returned.</p>
</td></tr>
<tr valign="top"><td><code>subset</code></td>
<td>
<p>A numeric vector specifying
the posterior samples to be used. 
If <code>NULL</code> (the default), all samples are used.</p>
</td></tr>
<tr valign="top"><td><code>nsamples</code></td>
<td>
<p>Positive integer indicating how many 
posterior samples should be used. 
If <code>NULL</code> (the default) all samples are used.
Ignored if <code>subset</code> is not <code>NULL</code>.</p>
</td></tr>
<tr valign="top"><td><code>nug</code></td>
<td>
<p>Small positive number for Gaussian process terms only. 
For numerical reasons, the covariance matrix of a Gaussian 
process might not be positive definite. Adding a very small 
number to the matrix's diagonal often solves this problem. 
If <code>NULL</code> (the default), <code>nug</code> is chosen internally.</p>
</td></tr>
<tr valign="top"><td><code>summary</code></td>
<td>
<p>Should summary statistics 
(i.e. means, sds, and 95% intervals) be returned
instead of the raw values? Default is <code>TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>robust</code></td>
<td>
<p>If <code>FALSE</code> (the default) the mean is used as 
the measure of central tendency and the standard deviation as 
the measure of variability. If <code>TRUE</code>, the median and the 
median absolute deviation (MAD) are applied instead.
Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>probs</code></td>
<td>
<p>The percentiles to be computed by the <code>quantile</code> 
function. Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>log</code></td>
<td>
<p>Logical; Indicates whether to return 
probabilities on the log-scale.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The returned probabilities can be written as
<i>P(Kn = k | Yn)</i>, that is the posterior probability 
that observation n originates from component k. 
They are computed using Bayes' Theorem
</p>
<p style="text-align: center;"><i>P(Kn = k | Yn) = P(Yn | Kn = k) P(Kn = k) / P(Yn),</i></p>

<p>where <i>P(Yn | Kn = k)</i> is the (posterior) likelihood
of observation n for component k, <i>P(Kn = k)</i> is 
the (posterior) mixing probability of component k 
(i.e. parameter <code>theta&lt;k&gt;</code>), and 
</p>
<p style="text-align: center;"><i>P(Yn) = &sum; (k=1,...,K) P(Yn | Kn = k) P(Kn = k)</i></p>

<p>is a normalizing constant.
</p>


<h3>Value</h3>

<p>If <code>summary = TRUE</code>, an N x E x K array,
where N is the number of observations, K is the number
of mixture components, and E is equal to <code>length(probs) + 2</code>.
If <code>summary = FALSE</code>, an S x N x K array, where
S is the number of posterior samples.
</p>


<h3>Examples</h3>

<pre>
## Not run: 
## simulate some data
set.seed(1234)
dat &lt;- data.frame(
  y = c(rnorm(100), rnorm(50, 2)), 
  x = rnorm(150)
)
## fit a simple normal mixture model
mix &lt;- mixture(gaussian, nmix = 2)
prior &lt;- c(
  prior(normal(0, 5), Intercept, nlpar = mu1),
  prior(normal(0, 5), Intercept, nlpar = mu2),
  prior(dirichlet(2, 2), theta)
)
fit1 &lt;- brm(bf(y ~ x), dat, family = mix,
            prior = prior, chains = 2, inits = 0)
summary(fit1)
   
## compute the membership probabilities         
ppm &lt;- pp_mixture(fit1)
str(ppm)

## extract point estimates for each observation
head(ppm[, 1, ])

## classify every observation according to 
## the most likely component
apply(ppm[, 1, ], 1, which.max)

## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>brms</em> version 2.3.0 <a href="00Index.html">Index</a>]</div>
</body></html>
